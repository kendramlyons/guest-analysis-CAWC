---
title: "CAWC Arrivals Report"
author: "Kendra Lyons"
date: "2/2/2022"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
library(ggrepel)
library(ggthemes)
library(tidyverse)
opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Data Dates: 1/26/21-1/20/22

```{r data, echo = FALSE}

arrivals_7_day <- read_csv("data/arrival_date_counts_1.20.csv") %>%
  mutate(arrival_month = factor(arrival_month))

arrivals_wkly <- read_csv("data/arrival_week_counts_1.20.csv")

#individuals <- read_csv("data/individual_all_clean_1_20_22.csv") %>% 
  #rename("groupID" = ...1)

stay_len_perc <- read_csv("data/stay_length_percent_1_20_22.csv")

#stay_len_gps <- read_csv("data/stay_length_percent_gps_1_20_22.csv")

groups <- read_csv("data/group_all_clean_1_20_22.csv") %>%
  filter(stay_length >= 0) %>%
  select(arrival_date, number_in_party, stay_length)

policy_events <- read_csv("data/migration_policy_events_timeline_2021_ selected.csv", skip = 2) %>%
  mutate(date = parse_date(date, format = "%m/%d/%Y"),
         category = factor(category))

key_policy_events <- policy_events %>%
  filter(category %in% c('MPP ("Remain in Mexico")', 
                         'Title 42', 'Temporary Protected Status')) #, 'Detention'


```

## Arrivals Timelines

Throughout **2021**, arrivals at Casa Alitas Welcome Center steadily increased from 
just a few to more than _300 people_ arriving in a single day. However, there were 
significant fluctuations in arrival numbers at several points in time, when policy 
changes at the federal level affected how border authorities in states along the 
Southern U.S.-Mexico border detained, deported and released individuals or groups 
of migrants of different nationalities. Data entrusted to staff and volunteers at 
Alitas illustrate these dramatic ups and downs in releases of migrants by CBP and 
ICE, but cannot capture the intensity of the reality on the ground; neither the 
uncertainty for those seeking asylum, nor the difficulty of coordinating the staff 
and volunteers working to offer them food, shelter, medical aid, travel assistance, 
information services (among other initiatives) according to a range of needs. 

```{r arriv7day, echo=FALSE}
# set plot theme
theme_set(theme_minimal(15))

# plot daily total arrivals (bars) and individual seven-day rolling mean (line)
arrivals_7_day %>%
ggplot(aes(x = arrival_date, y = n)) +
  geom_col(fill = 'orange') +
  geom_line(aes(y = seven_avg), 
            color = 'purple', size = .8) +
  geom_label_repel(aes(label = label),
                   nudge_y = 225,
                   na.rm = TRUE) +
  labs(title = "Change in daily arrivals over time",
       x = element_blank(), 
       y = "Number of Daily Arrivals") +
  scale_x_date(date_breaks = "1 month", 
               date_labels = "%b",
               date_minor_breaks = "1 year") # get rid of FEB on right
```

The increasing trend is even more evident in the plot below, which displays weekly 
arrival numbers with a linear regression line (purple) and confidence interval 
(shaded), and so are the abrupt and unusual drops in arrivals late in the year. 
Removing some noise by examining weekly rather than daily arrivals makes the scale 
of the fluctuations clearer. In October and December of 2021, there were several 
weeks with sudden and significant drops in arrivals that were _far_ outside of the 
predictable range of usual variation. However, knowledge of potential forthcoming 
policy changes gleaned through networks of migrant-serving organizations or direct 
communication with border authorities sometimes allowed staff to prepare for large 
drops or spikes in arrivals. 

```{r arrivwk, echo=FALSE}
# weekly arrivals barplot with linear regression
arrivals_wkly %>%
  ggplot(aes(x = week_number, y = n)) +
  geom_bar(stat = "identity", 
           fill = 'orange') +
  geom_smooth(method = "lm", formula = y ~ x, 
              color = 'purple', size=.8) +
  geom_label(aes(label = label),
             nudge_y = 50,
             na.rm = TRUE) +
  labs(title = "Change in weekly arrivals over time", 
       x = element_blank(),
       y = "Number of Weekly Arrivals")
```


```{r arrivmon, echo=FALSE}
# Monthly arrivals boxplot
arrivals_7_day %>% #weekly arrivals by month boxplots
  ggplot(aes(x = arrival_month, y = n)) +
  geom_hline(yintercept = 100, color = "darkgrey") +
  geom_boxplot(varwidth = TRUE, 
               outlier.color = "red") +
  #geom_label(aes(label = arrivals_7_day %>% count(arrival_month) %>% pull(mean(n)))) +
  labs(title = "Change in daily arrivals by month", 
       x = element_blank(), 
       y = "Number of Daily Arrivals") 
```

The month-by-month average of daily arrivals stayed below one-hundred throughout 
2021, only barely exceeding that number in the first twenty days of 2022. 

## Group Size Over Time

```{r grouptl, echo=FALSE}
# plot group size trends over time
groups %>% 
  ggplot(aes(x = arrival_date, 
             y = number_in_party)) +
  geom_jitter(aes(size = number_in_party), 
              alpha = .1, na.rm = TRUE, 
              show.legend = FALSE) +
  geom_vline(data = key_policy_events, 
             aes(xintercept = date, 
                 color = category),
             na.rm = TRUE,
             size =.75) +
  scale_color_manual(values = c("purple", "orange", "darkgreen")) +
  scale_x_date(date_breaks="1 month", 
               date_labels="%b") +
  labs(title = "Policy change effects by group size",
       x = element_blank(), 
       y = "Group Size",
       color = element_blank()) +
  theme(legend.position = "top", legend.justification = 0)
```

Different policies affect individual and groups of asylum seekers differently. 


## Stay Length, All Guests

```{r stayperc, echo=FALSE}
# plot stay length percentages
stay_len_perc %>%
  ggplot(aes(x = stay_length, 
             y = percent)) +
  geom_vline(xintercept = 6, size = .5, color = "grey") +
  geom_vline(xintercept = 11, size = .5, color = "grey") +
  geom_point(color = "purple", group = 1, na.rm = TRUE) +
  geom_line(color = "orange", na.rm = TRUE) +
  geom_label_repel(aes(label = label), 
                   nudge_y = 30,
                   na.rm = TRUE) + 
  labs(x = "Stay Length in Days", 
       y = "Percent of Arrivals") +
  scale_x_continuous(breaks = c(0, 5, 10 , 15, 20, 25, 30), 
                     limits = c(0,35))
```

Around 70% of guests moved on after one night or less. Most likely due to quarantine 
and re-testing protocol when an individual or member of a group tested positive for 
COVID-19, less than 2% of guests had stays of 6 days or 11 days respectively. 

```{r staydist, echo=FALSE}
# plot stay length counts
stay_len_perc %>% #filter out mistakes in recording year (negative values)
  ggplot(aes(x = stay_length, y = n)) +
  geom_vline(xintercept = 6, size = .5, color = "grey") +
  geom_vline(xintercept = 11, size = .5, color = "grey") +
  geom_vline(xintercept = 16, size = .5, color = "grey") +
  geom_col(fill = "orange", 
           na.rm = TRUE) +
  geom_label(aes(label = peak),
             nudge_y = 500,
             na.rm = TRUE) +
  labs(x = "Stay Length in Days", 
       y = "Number of Individuals") +
  scale_x_continuous(breaks = c(0, 5, 10 , 15, 20), 
                     limits = c(-1, 20))
```

Small peaks in stay lengths of six, eleven and sixteen days occurred, usually when 
an individual or all members of a group tested negative for COVID-19 and were able 
to depart. . . 

## Stay Length by Group Size

```{r gpstayjit, echo=FALSE}
# Look at distribution of group sizes for stays from 0-30 days
groups %>% 
  ggplot(aes(x = stay_length, 
             y = number_in_party)) +
  geom_vline(xintercept = 6, size = .5, color = "grey") +
  geom_vline(xintercept = 11, size = .5, color = "grey") +
  geom_vline(xintercept = 16, size = .5, color = "grey") +
  geom_vline(xintercept = 6, size = 10, alpha = .2, color = "yellow") +
  geom_vline(xintercept = 11, size = 10, alpha = .2, color = "yellow") +
  geom_vline(xintercept = 16, size = 10, alpha = .2, color = "yellow") +
  geom_jitter(aes(size = number_in_party), 
              show.legend = FALSE, 
              alpha = .2, na.rm = TRUE) +
  xlim(-1, 25) +   # align x-axis
  labs(y = "Group Size", 
       x = "Stay Length in Days")
```

Individuals with extended stays likely due to COVID-19 most commonly left after 
six days. It was more common for family groups, generally quarantining together 
in a hotel room where it was easy to infect those who had previously tested 
negative, which inevitably prolonged the quarantine. 

```{r staybp, echo=FALSE}
# box plots of stay lengths for various group sizes
groups  %>% 
  ggplot(aes(x = stay_length, 
             y = factor(number_in_party))) +
  geom_violin(aes(group = number_in_party), 
              color = "purple") +
  geom_boxplot(varwidth = TRUE, 
               outlier.color = "red")  + # zoom in on plot because there are a few distant outliers
  labs(x = "Stay Length in Days",
       y = "Group Size") 
```

Individuals appear to move on more quickly in general, although some have extended 
stays due to extenuating circumstances such as issues with health, sponsors, court
dates or paperwork. . . Most guests, regardless of party size, move on within a day or two.



### Further Resources

- **American Immigration Council**: https://www.americanimmigrationcouncil.org/research/guide-title-42-expulsions-border
- **Arizona Public Media Video Feature**: https://www.youtube.com/watch?v=6FUyY0_exoo
- **Casa Alitas Program Website**: https://www.casaalitas.org/
- **Catholic Community Services of Southern Arizona**: https://www.ccs-soaz.org/agencies-ministries/detail/alitas-aid-for-migrant-women-and-children
- **FEMA Funds for Migrant Aid**: https://tucson.com/news/local/pima-county-uncertain-federal-funds-to-support-asylum-seekers-will-continue/article_1d07a4c8-901d-11ec-8e6c-a37e4491dcf4.html
- **Human Rights Watch**: https://www.hrw.org/news/2021/03/05/mexico-abuses-against-asylum-seekers-us-border
- **International Rescue Committee**: https://www.rescue.org/article/what-happening-us-southern-border
  - En espanol: https://www.rescue.org/article/que-esta-pasando-en-la-frontera-sur-de-estados-unidos
- **Southern Border Communities Coalition**: https://www.southernborder.org/border_lens_asylum_seekers_at_the_border
- **Tucson Sentinel**: https://www.tucsonsentinel.com/local/report/030122_casa_alitas_budget/pima-county-spending-13-million-per-month-shelter-migrants-released-by-dhs/
- **Tucson Weekly**: https://www.tucsonweekly.com/tucson/crowded-house-casa-alitas-faces-increased-pressure-as-more-migrants-seek-refugee-status/Content?oid=30449369
- **U.S. Citizenship and Immigration Services**: https://www.uscis.gov/humanitarian/refugees-and-asylum/asylum/obtaining-asylum-in-the-united-states